(window.webpackJsonp=window.webpackJsonp||[]).push([[229],{1286:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return GoogleOneTapController}));var controllers_ez_base_controller__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(15),scriptjs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(88),scriptjs__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(scriptjs__WEBPACK_IMPORTED_MODULE_1__),js_cookie__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),js_cookie__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(js_cookie__WEBPACK_IMPORTED_MODULE_2__),axios__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(36),axios__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_3__),lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(58),lib_ez_custom_events__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(20),components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6),components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9);function _classCallCheck(e,_){if(!(e instanceof _))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,_){for(var t=0;t<_.length;t++){var n=_[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,_,t){return _&&_defineProperties(e.prototype,_),t&&_defineProperties(e,t),e}function _inherits(e,_){if("function"!==typeof _&&null!==_)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(_&&_.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),_&&_setPrototypeOf(e,_)}function _setPrototypeOf(e,_){return _setPrototypeOf=Object.setPrototypeOf||function(e,_){return e.__proto__=_,e},_setPrototypeOf(e,_)}function _createSuper(e){var _=_isNativeReflectConstruct();return function(){var t,n=_getPrototypeOf(e);if(_){var o=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,_){return!_||"object"!==typeof _&&"function"!==typeof _?_assertThisInitialized(e):_}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}var GoogleOneTapController=function(_EzController){_inherits(GoogleOneTapController,_EzController);var _super=_createSuper(GoogleOneTapController);function GoogleOneTapController(){var _this;_classCallCheck(this,GoogleOneTapController);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=_super.call.apply(_super,[this].concat(args)),_this.initOneTap=function(){window.google.accounts.id.initialize({client_id:_this.clientId,callback:_this.handleCredentialResponse,context:_this.element.dataset.context,state_cookie_domain:_this.element.dataset.stateCookieDomain,auto_select:_this.element.dataset.autoSelect}),window.google.accounts.id.prompt(_this.sendDialogTriggerEvent)},_this.sendDialogTriggerEvent=function(e){e.isDisplayed()&&Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_6__.k)({element:_this.element,data:{action:components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_7__.lb,non_interaction:!0}})},_this.handleCredentialResponse=function(response){var url=_this.element.dataset.loginUri;return js_cookie__WEBPACK_IMPORTED_MODULE_2___default.a.set("g_csrf_token",_this.csrfToken),axios__WEBPACK_IMPORTED_MODULE_3___default.a.defaults.headers.common["X-CSRF-Token"]=_this.csrfToken,axios__WEBPACK_IMPORTED_MODULE_3___default.a.post("".concat(url,"?credential=").concat(response.credential,"&g_csrf_token=").concat(_this.csrfToken),response).then((function(res){res.request.responseURL.includes("google_one_tap")?(200!==res.status&&204!==res.status||(Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.a)()?(eval(res.data),Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_6__.l)({action:components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_7__.kb,category:"Trigger-One_Tap",label:"Sign_Up-One_Tap",dataLayerCompleteAttrs:["email_address","email_hash_md5","email_hash_sha1","sign_in_type"]})):(js_cookie__WEBPACK_IMPORTED_MODULE_2___default.a.get("sign_in_referrer")?window.location.assign(js_cookie__WEBPACK_IMPORTED_MODULE_2___default.a.get("sign_in_referrer")):window.location.reload(),Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_6__.l)({action:components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_7__.yb,category:"Trigger-One_Tap",label:"Sign_In-One_Tap",dataLayerCompleteAttrs:["email_address","email_hash_md5","email_hash_sha1","sign_in_type","name","country","postal_code","team_owner_email","team_seats","multiple_logins"]}))),Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.b)()):window.location.assign(res.request.responseURL)}))},_this}return _createClass(GoogleOneTapController,[{key:"connect",value:function(){var e=this;this.clientId=this.element.dataset.clientId,scriptjs__WEBPACK_IMPORTED_MODULE_1___default()("https://accounts.google.com/gsi/client",(function(){e.initOneTap(),e.flagLoaded()})),window.addEventListener(lib_ez_custom_events__WEBPACK_IMPORTED_MODULE_5__.o,this.initOneTap)}},{key:"disconnect",value:function(){window.removeEventListener(lib_ez_custom_events__WEBPACK_IMPORTED_MODULE_5__.o,this.initOneTap)}}]),GoogleOneTapController}(controllers_ez_base_controller__WEBPACK_IMPORTED_MODULE_0__.a)}}]);
//# sourceMappingURL=229-c9a05cd244fa47136738.chunk.js.map