(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{1171:function(e,t,n){"use strict";n.r(t);n(660),n.p,n(661),n(662),n.p,n.p;var _=n(8),o=n(18),i=n(88),a=n.n(i),r=n(3);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var _=t[n];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(e,_.key,_)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,_=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(_,arguments,o)}else n=_.apply(this,arguments);return f(this,n)}}function f(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var h=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(i,e);var t,n,_,o=u(i);function i(){var e;s(this,i);for(var t=arguments.length,n=new Array(t),_=0;_<t;_++)n[_]=arguments[_];return(e=o.call.apply(o,[this].concat(n))).recaptchaCallback=function(){var t={sitekey:e.siteKeyValue};"invisible"===e.element.dataset.captchaType&&(t.size="invisible",t.badge="inline");var n=grecaptcha.render(e.element,t);e.element.dataset.recaptchaId=n},e.rescaleCaptcha=function(){var t=e.element.parentNode.clientWidth,n=t<302?t/302:1;e.element.style.transform="scale(".concat(n,")"),e.element.style.transformOrigin="0 0"},e}return t=i,(n=[{key:"connect",value:function(){Object(r.P)()||this.initRecaptcha()}},{key:"disconnect",value:function(){"invisible"!==this.element.dataset.captchaType&&window.removeEventListener("resize",this.rescaleCaptcha)}},{key:"initRecaptcha",value:function(){var e=this;window.recaptchaCallback=this.recaptchaCallback,"undefined"!==typeof grecaptcha?recaptchaCallback():a()("https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit"),"invisible"!==this.element.dataset.captchaType&&(window.addEventListener("resize",this.rescaleCaptcha),setTimeout((function(){e.rescaleCaptcha()})))}}])&&c(t.prototype,n),_&&c(t,_),i}(o.b);h.values={siteKey:String};var d=n(15),E=n(513),b=n(514),g=n(13),O=n.n(g),P=n(97);function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var _=t[n];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(e,_.key,_)}}function D(e,t){return D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},D(e,t)}function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,_=k(e);if(t){var o=k(this).constructor;n=Reflect.construct(_,arguments,o)}else n=_.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}var v=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&D(e,t)}(i,e);var t,n,_,o=M(i);function i(){var e;T(this,i);for(var t=arguments.length,n=new Array(t),_=0;_<t;_++)n[_]=arguments[_];return(e=o.call.apply(o,[this].concat(n))).connectFacebook=function(){e.facebook.connect()},e.connectGoogle=function(){e.google.connect()},e}return t=i,(n=[{key:"connect",value:function(){this.connectType=this.element.dataset.connectType,O.a.set("sessionViewActivity",Object(P.f)()),O.a.set("sessionDownloadActivity",Object(P.d)()),this.facebook=new E.a({buttonTarget:this.fbButtonTarget,textTarget:this.hasFbTextTarget?this.fbTextTarget:null,csrfToken:this.csrfToken,omniauthToken:this.element.dataset.omniauthToken}),this.google=new b.a({buttonTarget:this.googleButtonTarget,textTarget:this.hasGoogleTextTarget?this.googleTextTarget:null,csrfToken:this.csrfToken,omniauthToken:this.element.dataset.omniauthToken})}}])&&m(t.prototype,n),_&&m(t,_),i}(d.a);v.targets=["fbButton","fbText","googleButton","googleText"],Promise.resolve().then(n.bind(null,1212)),Promise.all([n.e(9),n.e(13),n.e(15),n.e(14),n.e(231)]).then(n.bind(null,1277)).then((function(e){_.default.register("registrations-account-form",e.default)})),Promise.all([n.e(9),n.e(13),n.e(15),n.e(14),n.e(232)]).then(n.bind(null,1278)).then((function(e){_.default.register("registrations-details-form",e.default)})),Promise.all([n.e(9),n.e(13),n.e(15),n.e(14),n.e(230)]).then(n.bind(null,1279)).then((function(e){_.default.register("login-form",e.default)})),Promise.all([n.e(9),n.e(13),n.e(15),n.e(14),n.e(233)]).then(n.bind(null,1280)).then((function(e){_.default.register("reset-password-form",e.default)})),Promise.all([n.e(10),n.e(17),n.e(234)]).then(n.bind(null,1281)).then((function(e){_.default.register("signup-modal",e.default)})),Promise.all([n.e(29),n.e(10),n.e(17),n.e(235)]).then(n.bind(null,1282)).then((function(e){_.default.register("signup-survey-component",e.default)})),Promise.all([n.e(9),n.e(13),n.e(15),n.e(14),n.e(236)]).then(n.bind(null,1283)).then((function(e){_.default.register("signup-survey-form",e.default)})),Promise.all([n.e(29),n.e(10),n.e(17),n.e(237)]).then(n.bind(null,1284)).then((function(e){_.default.register("email-verification-modal",e.default)})),Promise.all([n.e(10),n.e(16),n.e(17),n.e(228)]).then(n.bind(null,1285)).then((function(e){_.default.register("email-verified-modal",e.default)})),Promise.all([n.e(19),n.e(229)]).then(n.bind(null,1286)).then((function(e){_.default.register("google-one-tap",e.default)})),_.default.register("recaptcha",h),_.default.register("social-session-buttons",v)},1212:function(e,t,n){"use strict";n.r(t);n(663),n.p},513:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return FacebookLogin}));var scriptjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(88),scriptjs__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(scriptjs__WEBPACK_IMPORTED_MODULE_0__),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(36),axios__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__),lib_helpers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3),js_cookie__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(13),js_cookie__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(js_cookie__WEBPACK_IMPORTED_MODULE_3__),components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(9),lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(58);function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var _=t[n];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(e,_.key,_)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var FacebookLogin=function(){function FacebookLogin(e){var t=this,n=e.buttonTarget,_=e.textTarget,o=void 0===_?null:_,i=e.csrfToken,a=e.omniauthToken;_classCallCheck(this,FacebookLogin),this.loadFacebookApi=function(){window.FB.init({appId:t.buttonTarget.dataset.appId,autoLogAppEvents:!0,cookie:!0,status:!0,xfbml:!1,version:"v3.2"}),t.buttonTarget.dataset.loaded="true"},this.handleFacebookResponse=function(){axios__WEBPACK_IMPORTED_MODULE_1___default.a.defaults.headers.common["X-CSRF-Token"]=t.csrfToken,axios__WEBPACK_IMPORTED_MODULE_1___default.a.post(t.buttonTarget.dataset.omniauthPath,t.formDataForAjaxPost,{withCredentials:!0}).then((function(e){t.responseSuccess(e)})).catch(t.handleError)},this.responseSuccess=function(e){200===e.status||204===e.status?t.processResponse(e):t.handleError(e.error),Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.b)()},this.loginReject=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.textTarget&&Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.f)(t.buttonTarget,t.originalText),Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.d)(e,t.buttonTarget),e&&(t.authType="rerequest")},this.handleError=function(e){e&&console.error(e),t.textTarget&&Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.f)(t.buttonTarget,t.originalText),Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.d)(!0,t.buttonTarget)},this.buttonTarget=n,this.textTarget=o,this.csrfToken=i,this.omniauthToken=a,this.connectType=n.getAttribute("data-oauth-type"),this.handleFacebookResponse=this.handleFacebookResponse.bind(this),this.handleError=this.handleError.bind(this),this.init()}return _createClass(FacebookLogin,[{key:"init",value:function(){Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.d)(!1,this.buttonTarget),this.authType="reauthorize",scriptjs__WEBPACK_IMPORTED_MODULE_0___default()("https://connect.facebook.net/en_US/sdk.js",this.loadFacebookApi)}},{key:"connect",value:function(){var e=this,t=document.getElementById("user_newsletter"),n=!1;null!==t&&"hidden"!==t.type?n=t.checked:null!==t&&"hidden"===t.type&&(n=!0);var _=this.buttonTarget.dataset.omniauthPath,o="".concat(_,"/callback?newsletter=").concat(n,"&state=").concat(this.omniauthToken);this.buttonTarget.dataset.omniauthPath=o,this.textTarget&&(this.originalText=this.textTarget.innerHTML,Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.f)(this.buttonTarget)),this.login().then((function(){e.validate().then((function(){e.handleFacebookResponse()}),(function(){e.loginReject(!0)}))}),(function(){e.loginReject()}))}},{key:"formDataForAjaxPost",get:function(){var e=new FormData;return e.append("authenticity_token",this.csrfToken),e}},{key:"processResponse",value:function processResponse(response){if(Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.a)())return Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.c)(response)&&eval(response.data),void Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_4__.l)({action:components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_5__.kb,category:Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_4__.e)(this.buttonTarget),label:"Sign_Up-Facebook",dataLayerCompleteAttrs:["email_address","email_hash_md5","email_hash_sha1","sign_in_type"]});Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_4__.l)({action:components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_5__.yb,category:Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_4__.e)(this.buttonTarget),label:"Sign_In-Facebook",dataLayerCompleteAttrs:["email_address","email_hash_md5","email_hash_sha1","sign_in_type","name","country","postal_code","team_owner_email","team_seats","multiple_logins"]}),this.fromFollow?window.location.reload():"login_in_place"===response.data.message?Object(lib_helpers__WEBPACK_IMPORTED_MODULE_2__.W)("LoggedInPlace"):js_cookie__WEBPACK_IMPORTED_MODULE_3___default.a.get("sign_in_referrer")?window.location.assign(js_cookie__WEBPACK_IMPORTED_MODULE_3___default.a.get("sign_in_referrer")):window.location.reload()}},{key:"fromFollow",get:function(){return Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_6__.e)()}},{key:"login",value:function(){var e=this;return new Promise((function(t,n){window.FB.login((function(e){"connected"===e.status?t():n()}),{scope:"public_profile,email",auth_type:e.authType})}))}},{key:"validate",value:function(){return new Promise((function(e,t){window.FB.api("/me/permissions",(function(n){n.data.forEach((function(e){"email"===e.permission&&"granted"!==e.status&&t(),"public_profile"===e.permission&&"granted"!==e.status&&t()})),e()}))}))}}]),FacebookLogin}()},514:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return GoogleLogin}));var scriptjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(88),scriptjs__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(scriptjs__WEBPACK_IMPORTED_MODULE_0__),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(36),axios__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__),js_cookie__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),js_cookie__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(js_cookie__WEBPACK_IMPORTED_MODULE_2__),lib_helpers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(3),lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(58),components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6),components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(9);function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var _=t[n];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(e,_.key,_)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var GoogleLogin=function(){function GoogleLogin(e){var t=this,n=e.buttonTarget,_=e.textTarget,o=void 0===_?null:_,i=e.csrfToken,a=e.omniauthToken;_classCallCheck(this,GoogleLogin),this.loadGoogleApi=function(){window.gapi.load("auth2",null),t.buttonTarget.dataset.loaded="true"},this.responseSuccess=function(e){200===e.status||204===e.status?t.processResponse(e):t.handleError(e.error),Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.b)()},this.handleError=function(e){e&&console.error(e),t.textTarget&&Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.f)(t.buttonTarget,t.originalText),Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.d)(!0,t.buttonTarget)},this.buttonTarget=n,this.textTarget=o,this.csrfToken=i,this.omniauthToken=a,this.handleGoogleResponse=this.handleGoogleResponse.bind(this),this.handleError=this.handleError.bind(this),this.init()}return _createClass(GoogleLogin,[{key:"init",value:function(){Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.d)(!1,this.buttonTarget),scriptjs__WEBPACK_IMPORTED_MODULE_0___default()("https://apis.google.com/js/platform.js",this.loadGoogleApi)}},{key:"connect",value:function(){this.textTarget&&(this.originalText=this.textTarget.innerHTML,Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.f)(this.buttonTarget)),Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.d)(!1,this.buttonTarget),this.login()}},{key:"login",value:function(){window.gapi.auth2.authorize({client_id:this.buttonTarget.dataset.appId,cookie_policy:"single_host_origin",scope:"email profile",response_type:"code"},this.handleGoogleResponse)}},{key:"handleGoogleResponse",value:function(e){if(e&&!e.error){var t=document.getElementById("user_newsletter"),n=!1;null!==t&&"hidden"!==t.type?n=t.checked:null!==t&&"hidden"===t.type&&(n=!0),axios__WEBPACK_IMPORTED_MODULE_1___default.a.defaults.headers.common["X-CSRF-Token"]=this.csrfToken,axios__WEBPACK_IMPORTED_MODULE_1___default.a.post("/users/auth/google_oauth2/callback?state=".concat(this.omniauthToken,"&newsletter=").concat(n),e).then(this.responseSuccess).catch(this.handleError)}else this.handleError(null==e?void 0:e.error)}},{key:"processResponse",value:function processResponse(response){if(Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.a)())return Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.c)(response)&&eval(response.data),void Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_5__.l)({action:components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_6__.kb,category:Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_5__.e)(this.buttonTarget),label:"Sign_Up-Google",dataLayerCompleteAttrs:["email_address","email_hash_md5","email_hash_sha1","sign_in_type"]});Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_5__.l)({action:components_analytics_conversions_constants_actions__WEBPACK_IMPORTED_MODULE_6__.yb,category:Object(components_analytics_conversions_tracking__WEBPACK_IMPORTED_MODULE_5__.e)(this.buttonTarget),label:"Sign_In-Google",dataLayerCompleteAttrs:["email_address","email_hash_md5","email_hash_sha1","sign_in_type","name","country","postal_code","team_owner_email","team_seats","multiple_logins"]}),this.fromFollow?window.location.reload():"login_in_place"===response.data.message?Object(lib_helpers__WEBPACK_IMPORTED_MODULE_3__.W)("LoggedInPlace"):js_cookie__WEBPACK_IMPORTED_MODULE_2___default.a.get("sign_in_referrer")?window.location.assign(js_cookie__WEBPACK_IMPORTED_MODULE_2___default.a.get("sign_in_referrer")):window.location.reload()}},{key:"fromFollow",get:function(){return Object(lib_social_session_helpers__WEBPACK_IMPORTED_MODULE_4__.e)()}}]),GoogleLogin}()},58:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return f}));var _=n(27),o=n(26),i=n(13),a=n.n(i);function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.querySelector('[data-social-session-buttons-target*="text"]')||null;n.innerHTML=t||e.dataset.loadingText}function s(e,t){e?Object(_.b)(t,Object(o.c)(t,"permissions_error")):Object(_.c)(t)}function c(){var e=a.a.get("primer_for_post_login_cookie");return!(!e||!e.includes("follow_after_login"))}function l(){return"registration"===a.a.get("social_oauth_type")}function u(e){return"text/javascript; charset=utf-8"===e.headers["content-type"]}function f(){a.a.remove("social_oauth_type")}},660:function(e,t,n){},661:function(e,t,n){},662:function(e,t,n){},663:function(e,t,n){}}]);
//# sourceMappingURL=sessions-a6bc0eb7c8d853b31c16.chunk.js.map